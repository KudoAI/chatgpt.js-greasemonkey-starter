import js from '@eslint/js';
import globals from 'globals';
import eslintPluginJsonSchemaValidator from 'eslint-plugin-json-schema-validator';

export default [
    js.configs.recommended,
    { ignores: ['**/*.min.js'] },
    {
        rules: {
            'indent': 'off', 'no-unexpected-multiline': 'off', // allow whitespace anywhere
            'semi': ['error', 'always'], // enforce semicolons at end of statement
            'quotes': ['error', 'single', { 'allowTemplateLiterals': true }], // enforce single quotes except backticks to avoid escaping quotes
            'key-spacing': ['error', { 'beforeColon': false, 'afterColon': true }], // enforce spacing in object properties
            'comma-dangle': ['error', 'never'], // enforce no trailing commas in arrays or objects
            'no-async-promise-executor': 'off', // allow promise executor functions to be async (to accomodate await lines)
            'no-constant-condition': 'off', // allow constant conditions
            'no-empty': 'off', // allow empty blocks
            'no-inner-declarations': 'off', // allow function declarations anywhere
            'no-useless-escape': 'off', // allow all escape chars cause ESLint sucks at detecting truly useless ones
            'no-unused-vars': ['error', { 'caughtErrors': 'none' }] // allow unused named args in catch blocks
        },
        languageOptions: {
            ecmaVersion: 2022, sourceType: 'script',
            globals: { ...globals.browser, ...globals.greasemonkey, chatgpt: 'readonly' }
        }
    },
    { files: ['**/*.mjs', '**/lib*/*.js'], languageOptions: { sourceType: 'module' }},
    ...eslintPluginJsonSchemaValidator.configs['flat/recommended']
];
/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/@kudoai/chatgpt.js@2.6.10/chatgpt.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
const endpoints={assets:"https://cdn.jsdelivr.net/gh/KudoAI/chatgpt.js",openAI:{session:"https://chatgpt.com/api/auth/session",chats:"https://chat.openai.com/backend-api/conversations",chat:"https://chat.openai.com/backend-api/conversation",share_create:"https://chat.openai.com/backend-api/share/create",share:"https://chat.openai.com/backend-api/share",instructions:"https://chat.openai.com/backend-api/user_system_messages"}};localStorage.alertQueue=JSON.stringify([]),localStorage.notifyProps=JSON.stringify({queue:{topRight:[],bottomRight:[],bottomLeft:[],topLeft:[]}});const chatgpt={openAIaccessToken:{},actAs:function(e){return new Promise(((t,n)=>{const o=new XMLHttpRequest;o.open("GET","https://raw.githubusercontent.com/KudoAI/chat-prompts/main/dist/personas.min.json",!0),o.send(),o.onload=()=>{if(200!==o.status)return n("ðŸ¤– chatgpt.js >> Request failed. Cannot retrieve prompts data.");const r=JSON.parse(o.responseText).personas;if(!e){console.log("\n%cðŸ¤– chatgpt.js personas\n","font-family: sans-serif ; font-size: xxx-large ; font-weight: bold");for(const e of r)console.log(`%c${e.title}`,"font-family: monospace ; font-size: larger ;");return t()}const s=r.find((t=>t.title.toLowerCase()==e.toLowerCase()));return s?(chatgpt.send(s.prompt,"click"),console.info(`Loading ${e} persona...`),chatgpt.isIdle().then((()=>{console.info("Persona activated!")})),t()):n(`ðŸ¤– chatgpt.js >> Persona '${e}' was not found!`)}}))},activateDarkMode:function(){document.documentElement.classList.replace("light","dark"),document.documentElement.style.colorScheme="dark",localStorage.setItem("theme","dark")},activateLightMode:function(){document.documentElement.classList.replace("dark","light"),document.documentElement.style.colorScheme="light",localStorage.setItem("theme","light")},alert:function(e,t,n,o,r){const s=chatgpt.isDarkMode()?"dark":"light",a=chatgpt.browser.isMobile(),i=document.createElement("div");i.id=Math.floor(1e6*chatgpt.randomFloat())+Date.now(),i.classList.add("chatgpt-modal");const c=document.createElement("div"),l=document.createElement("h2"),u=document.createElement("p"),d=20231203;let p=document.querySelector("#chatgpt-modal-style");(!p||parseInt(p.getAttribute("last-updated"),10)<d)&&(p||(p=document.createElement("style"),p.id="chatgpt-modal-style",p.setAttribute("last-updated",d.toString()),document.head.append(p)),p.innerText=`.chatgpt-modal {position: fixed ; top: 0 ; left: 0 ; width: 100% ; height: 100% ;background-color: rgba(67, 70, 72, 0) ;transition: background-color 0.05s ease ;display: flex ; justify-content: center ; align-items: center ; z-index: 9999 }.chatgpt-modal > div {opacity: 0 ; transform: translateX(-2px) translateY(5px) ; max-width: 75vw ; word-wrap: break-word ;transition: opacity 0.1s cubic-bezier(.165,.84,.44,1), transform 0.2s cubic-bezier(.165,.84,.44,1) ;background-color: ${"dark"==s?"black":"white"} ;`+("dark"!=s?"border: 1px solid rgba(0, 0, 0, 0.3) ;":"")+"padding: 20px ; margin: 12px 23px ; border-radius: 15px ; box-shadow: 0 30px 60px rgba(0, 0, 0, .12) ; -webkit-user-select: none ; -moz-user-select: none ; -ms-user-select: none ; user-select: none ; }.chatgpt-modal h2 { margin-bottom: 9px }"+`.chatgpt-modal a { color: ${"dark"==s?"#00cfff":"#1e9ebb"}}.chatgpt-modal.animated > div { opacity: 1 ; transform: translateX(0) translateY(0) }@keyframes alert-zoom-fade-out { 0% { opacity: 1 ; transform: scale(1) }50% { opacity: 0.25 ; transform: scale(1.05) }100% { opacity: 0 ; transform: scale(1.35) }}.modal-buttons { display: flex ; justify-content: flex-end ; margin: 20px -5px -3px 0 ;`+(a?"flex-direction: column-reverse":"")+"}.chatgpt-modal button {"+`margin-left: ${a?0:10}px ; padding: ${a?15:4}px 18px ; border-radius: 15px ;`+(a?"margin-top: 5px ; margin-bottom: 3px ;":"")+`border: 1px solid ${"dark"==s?"white":"black"}}.primary-modal-btn {`+`border: 1px solid ${"dark"==s?"white":"black"} ;`+`background: ${"dark"==s?"white":"black"} ;`+`color: ${"dark"==s?"black":"white"}}.chatgpt-modal button:hover { color: #3d5d71 ; border-color: #6d9cb9 ;background-color: `+("dark"==s?"#00cfff":"#9cdaff")+";box-shadow: 2px 1px "+("dark"==s?"54px #00cfff":"30px #9cdaff")+"}.modal-close-btn {cursor: pointer ; width: 20px ; height: 20px ; float: right ; position: relative ; right: -2px }.modal-close-btn svg { margin: 5px 5px }"+`.modal-close-btn:hover { background-color: #f2f2f2${"dark"==s?"00":""}}.chatgpt-modal .checkbox-group { display: flex ; margin-top: -18px }.chatgpt-modal .checkbox-group label {font-size: .7rem ; margin: -.04rem 0 0px .3rem ;`+`color: ${"dark"==s?"#e1e1e1":"#1e1e1e"}}.chatgpt-modal input[type="checkbox"] { transform: scale(0.7) ;`+`border: 1px solid ${"dark"==s?"white":"black"}}.chatgpt-modal input[type="checkbox"]:checked {`+`border: 1px solid ${"dark"==s?"white":"black"} ;background-color: black ; position: inherit }.chatgpt-modal input[type="checkbox"]:focus { outline: none ; box-shadow: none }`),l.innerText=e||"",u.innerText=t||"",this.renderHTML(u);const g=document.createElement("div");g.classList.add("modal-buttons"),n&&(Array.isArray(n)||(n=[n]),n.forEach((e=>{const t=document.createElement("button");t.textContent=e.name.replace(/[_-]\w/g,(e=>e.slice(1).toUpperCase())).replace(/([A-Z])/g," $1").replace(/^\w/,(e=>e.toUpperCase())),t.addEventListener("click",(()=>{S(),e()})),g.insertBefore(t,g.firstChild)})));const h=document.createElement("button");h.textContent=n?"Dismiss":"OK",g.insertBefore(h,g.firstChild),g.lastChild.classList.add("primary-modal-btn");const f=document.createElement("div");if(o){f.classList.add("checkbox-group");const e=o,t=document.createElement("input");t.type="checkbox",t.addEventListener("change",e);const n=document.createElement("label");n.addEventListener("click",(()=>{t.checked=!t.checked,e()})),n.textContent=e.name.charAt(0).toUpperCase()+e.name.slice(1).replace(/([A-Z])/g,((e,t)=>" "+t.toLowerCase())).replace(/\b(\w+)nt\b/gi,"$1n't").trim(),f.append(t),f.append(n)}const m=document.createElement("div");m.title="Close",m.classList.add("modal-close-btn");const y=document.createElementNS("http://www.w3.org/2000/svg","svg");y.setAttribute("height","10px"),y.setAttribute("viewBox","0 0 14 14"),y.setAttribute("fill","none");const w=document.createElementNS("http://www.w3.org/2000/svg","path");w.setAttribute("fill-rule","evenodd"),w.setAttribute("clip-rule","evenodd"),w.setAttribute("fill",chatgpt.isDarkMode()?"white":"black"),w.setAttribute("d","M13.7071 1.70711C14.0976 1.31658 14.0976 0.683417 13.7071 0.292893C13.3166 -0.0976312 12.6834 -0.0976312 12.2929 0.292893L7 5.58579L1.70711 0.292893C1.31658 -0.0976312 0.683417 -0.0976312 0.292893 0.292893C-0.0976312 0.683417 -0.0976312 1.31658 0.292893 1.70711L5.58579 7L0.292893 12.2929C-0.0976312 12.6834 -0.0976312 13.3166 0.292893 13.7071C0.683417 14.0976 1.31658 14.0976 1.70711 13.7071L7 8.41421L12.2929 13.7071C12.6834 14.0976 13.3166 14.0976 13.7071 13.7071C14.0976 13.3166 14.0976 12.6834 13.7071 12.2929L8.41421 7L13.7071 1.70711Z"),y.append(w),m.append(y);[m,l,u,g,f].forEach((e=>{c.append(e)})),c.style.width=`${r||458}px`,i.append(c),document.body.append(i);let b=JSON.parse(localStorage.alertQueue);b.push(i.id),localStorage.alertQueue=JSON.stringify(b),i.style.display="none",1===b.length&&(i.style.display="",setTimeout((()=>{i.style.backgroundColor=`rgba(67, 70, 72, ${"dark"===s?.62:0})`,i.classList.add("animated")}),100));const x=e=>{(e.target==e.currentTarget||e.target instanceof SVGPathElement)&&S()},v=e=>{if([13,27].includes(e.keyCode))for(const t of b){const n=document.getElementById(t);if(n&&"none"!==n.style.display){if(27===e.keyCode)S();else if(13===e.keyCode){const t=n.querySelector(".modal-buttons").lastChild;t&&(t.click(),e.preventDefault())}return}}},C=[i,m,y,h];C.forEach((e=>{e.addEventListener("click",x)})),document.addEventListener("keydown",v);const S=()=>{i.style.backgroundColor="transparent",c.style.animation="alert-zoom-fade-out 0.075s ease-out",setTimeout((()=>{if(i.remove(),b=JSON.parse(localStorage.alertQueue),b.shift(),localStorage.alertQueue=JSON.stringify(b),C.forEach((e=>{e.removeEventListener("click",x)})),document.removeEventListener("keydown",v),b.length>0){const e=document.getElementById(b[0]);setTimeout((()=>{e.style.display="",setTimeout((()=>{e.classList.add("animated")}),100)}),500)}}),50)};return i.id},askAndGetReply:async function(e){return chatgpt.send(e),await chatgpt.isIdle(),chatgpt.getChatData("active","msg","chatgpt","latest")},autoRefresh:{activate:function(e){if(this.isActive)return void console.log("â†» ChatGPT >> ["+chatgpt.autoRefresh.nowTimeStamp()+"] Auto refresh already active!");const t=this;this.toggle.refreshFrame();const n=e=>{const o=Math.max(2,Math.floor(21*chatgpt.randomFloat()-10));t.isActive=setTimeout((()=>{const o=document.querySelector('script[src*="_ssgManifest.js"]');document.querySelector("#refresh-frame").src=o.src+"?"+Date.now(),console.log("â†» ChatGPT >> ["+t.nowTimeStamp()+"] ChatGPT session refreshed"),n(e)}),1e3*(e+o))};n(e?parseInt(e,10):30),console.log("â†» ChatGPT >> ["+chatgpt.autoRefresh.nowTimeStamp()+"] Auto refresh activated"),navigator.userAgent.includes("Chrome")&&void 0!==document.hidden&&document.addEventListener("visibilitychange",this.toggle.beacons)},deactivate:function(){this.isActive?(this.toggle.refreshFrame(),document.removeEventListener("visibilitychange",this.toggle.beacons),clearTimeout(this.isActive),this.isActive=null,console.log("â†» ChatGPT >> ["+chatgpt.autoRefresh.nowTimeStamp()+"] Auto refresh de-activated")):console.log("â†» ChatGPT >> ["+chatgpt.autoRefresh.nowTimeStamp()+"] Auto refresh already inactive!")},nowTimeStamp:function(){const e=new Date,t=e.getHours()%12||12;let n=e.getMinutes(),o=e.getSeconds();n<10&&(n="0"+n),o<10&&(o="0"+o);return t+":"+n+":"+o+" "+(e.getHours()<12?"AM":"PM")},toggle:{beacons:function(){chatgpt.autoRefresh.beaconID?(clearInterval(chatgpt.autoRefresh.beaconID),chatgpt.autoRefresh.beaconID=null,console.log("â†» ChatGPT >> ["+chatgpt.autoRefresh.nowTimeStamp()+"] Beacons de-activated")):(chatgpt.autoRefresh.beaconID=setInterval((()=>{navigator.sendBeacon("https://httpbin.org/post",new Uint8Array),console.log("â†» ChatGPT >> ["+chatgpt.autoRefresh.nowTimeStamp()+"] Beacon sent")}),9e4),console.log("â†» ChatGPT >> ["+chatgpt.autoRefresh.nowTimeStamp()+"] Beacons activated"))},refreshFrame:function(){let e=document.querySelector("#refresh-frame");e?e.remove():(e=Object.assign(document.createElement("iframe"),{id:"refresh-frame",style:"display: none"}),document.head.prepend(e))}}},browser:{isLightMode:function(){return window.matchMedia?.("(prefers-color-scheme: light)")?.matches},isDarkMode:function(){return window.matchMedia?.("(prefers-color-scheme: dark)")?.matches},isChromium:function(){return navigator.userAgent.includes("Chrome")},isFirefox:function(){return navigator.userAgent.includes("Firefox")},isFullScreen:function(){const e=navigator.userAgent;return e.includes("Chrome")?window.matchMedia("(display-mode: fullscreen)").matches:e.includes("Firefox")?window.fullScreen:/MSIE|rv:/.test(e)?document.msFullscreenElement:document.webkitIsFullScreen},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}},clearChats:async function(e){const t=["api","dom"];if((e=(e||"dom").trim().toLowerCase())&&!t.includes(e))return console.log(`Method argument must be one of: [${t}]`);if("dom"!=e)return new Promise(((e,t)=>{chatgpt.getAccessToken().then((n=>{const o=new XMLHttpRequest;o.open("PATCH",endpoints.openAI.chats,!0),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Authorization","Bearer "+n),o.onload=()=>{if(200!==o.status)return t("ðŸ¤– chatgpt.js >> Request failed. Cannot clear chats.");console.info("Chats successfully cleared"),e()},o.send(JSON.stringify({is_visible:!1}))})).catch(t)}));try{await chatgpt.getChatData()}catch{return}chatgpt.menu.open(),setTimeout((()=>{const e=document.querySelector('a[role="menuitem"] svg path[d*="M11.6439 3C10.9352"]').parentNode.parentNode;e&&e.click(),setTimeout((()=>{const e=document.querySelectorAll("[id*=radix] button"),t=e[e.length-1];t&&t.click(),setTimeout((()=>{document.querySelector('button[class*="danger"').click()}),10)}),333)}),10)},code:{execute:async function(e){return e?"string"!=typeof e?console.error("Code argument must be a string!"):(chatgpt.send("Display the output as if you were terminal:\n\n"+e),console.info("Executing code..."),await chatgpt.isIdle(),chatgpt.code.extract(await chatgpt.getChatData("active","msg","chatgpt","latest"))):console.error("Code argument not supplied. Pass some code!")},extract:function(e){const t=e.match(/(?<=```.*\n)[\s\S]*?(?=```)/g);return t?t[t.length-1]:e},minify:async function(e){return e?"string"!=typeof e?console.error("Code argument must be a string!"):(chatgpt.send("Minify the following code:\n\n"+e),console.info("Minifying code..."),await chatgpt.isIdle(),chatgpt.code.extract(await chatgpt.getChatData("active","msg","chatgpt","latest"))):console.error("Code argument not supplied. Pass some code!")},obfuscate:async function(e){return e?"string"!=typeof e?console.error("Code argument must be a string!"):(chatgpt.send("Obfuscate the following code:\n\n"+e),console.info("Obfuscating code..."),await chatgpt.isIdle(),chatgpt.code.extract(await chatgpt.getChatData("active","msg","chatgpt","latest"))):console.error("Code argument not supplied. Pass some code!")},refactor:async function(e,t){if(!e)return console.error("Code (1st) argument not supplied. Pass some code!");for(let e=0;e<arguments.length;e++)if("string"!=typeof arguments[e])return console.error(`Argument ${e+1} must be a string.`);return chatgpt.send("Refactor the following code for "+(t||"brevity")+":\n\n"+e),console.info("Refactoring code..."),await chatgpt.isIdle(),chatgpt.code.extract(await chatgpt.getChatData("active","msg","chatgpt","latest"))},review:async function(e){return e?"string"!=typeof e?console.error("Code argument must be a string!"):(chatgpt.send("Review the following code for me:\n\n"+e),console.info("Reviewing code..."),await chatgpt.isIdle(),chatgpt.getChatData("active","msg","chatgpt","latest")):console.error("Code argument not supplied. Pass some code!")},unminify:async function(e){return e?"string"!=typeof e?console.error("Code argument must be a string!"):(chatgpt.send("Unminify the following code.:\n\n"+e),console.info("Unminifying code..."),await chatgpt.isIdle(),chatgpt.code.extract(await chatgpt.getChatData("active","msg","chatgpt","latest"))):console.error("Code argument not supplied. Pass some code!")},write:async function(e,t){if(!e)return console.error("Prompt (1st) argument not supplied. Pass a prompt!");if(!t)return console.error("outputLang (2nd) argument not supplied. Pass a language!");for(let e=0;e<arguments.length;e++)if("string"!=typeof arguments[e])return console.error(`Argument ${e+1} must be a string.`);return chatgpt.send(e+"\n\nWrite this as code in "+t),console.info("Writing code..."),await chatgpt.isIdle(),chatgpt.code.extract(await chatgpt.getChatData("active","msg","chatgpt","latest"))}},detectLanguage:async function(e){return e?"string"!=typeof e?console.error("Text argument must be a string!"):(chatgpt.send("Detect the language of the following text:\n\n"+e+"\n\nOnly respond with the name of the language"),console.info("Reviewing text..."),await chatgpt.isIdle(),chatgpt.getChatData("active","msg","chatgpt","latest")):console.error("Text argument not supplied. Pass some text!")},executeCode:function(){chatgpt.code.execute()},exportChat:async function(e,t){e=e?Number.isInteger(e)||/^\d+$/.test(e)?parseInt(e,10):e:"active",t=t.toLowerCase()||"html",console.info("Generating transcript...");let n,o="";if(/te?xt/.test(t)){const t=new Date;if(n=`ChatGPT_${t.getDate().toString().padStart(2,"0")}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getFullYear()}_${t.getHours().toString().padStart(2,"0")}-${t.getMinutes().toString().padStart(2,"0")}.txt`,"active"==e&&/\/\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/.test(window.location.href)){const e=document.querySelectorAll("main > div > div > div > div > div > div[class*=group]");if(0===e.length)return console.error("Chat is empty!");const t=[];let n=!0;e.forEach((e=>{const o=n?"USER":"CHATGPT";n=!n;let r=Array.from(e.childNodes).map((e=>e.innerText)).join("\n\n").replace("Copy code","");t.push(o+": "+r)})),o=t.join("\n\n")}else for(const t of await chatgpt.getChatData(e,"msg","both","all"))o+=`USER: ${t.user}\n\n`,o+=`CHATGPT: ${t.chatgpt}\n\n`}else{const t=await fetch(await chatgpt.shareChat(e)),r=await t.text(),s=(new DOMParser).parseFromString(r,"text/html");n=s.querySelector("title").textContent+".html";s.querySelectorAll('link[rel="stylesheet"]').forEach((e=>{const t=e.getAttribute("href");t?.startsWith("/")&&e.setAttribute("href","https://chat.openai.com"+t)})),o=(new XMLSerializer).serializeToString(s)}if(console.info(`Exporting transcript as ${t.toUpperCase()}...`),"pdf"==t){o=o.replace(/<svg.*?<\/svg>/g,(e=>`<img src="${"data:image/svg+xml,"+encodeURIComponent(e)}">`));const e=window.open("","","toolbar=0, location=0, menubar=0, height=600, width=800");e.document.write(o),setTimeout((()=>{e.print({toPDF:!0})}),100)}else{if("md"==t){o=/<.*(?:<h1(.|\n)*?href=".*?continue[^"]*".*?\/a>.*?)<[^/]/.exec(o)[1]||o,n=n.replace(".html",".md")}const e=new Blob([o],{type:"text/"+("html"==t?"html":"md"==t?"markdown":"plain")}),r=document.createElement("a"),s=URL.createObjectURL(e);r.href=s,r.download=n,document.body.append(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s)}},extractCode:function(){chatgpt.code.extract()},generateRandomIP:function(){const e=Array.from({length:4},(()=>Math.floor(256*chatgpt.randomFloat()))).join(".");return console.info("IP generated: "+e),e},get:function(e,t=""){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Invalid arguments. Both arguments must be strings.");if(!targetTypes.includes(e.toLowerCase()))throw new Error("Invalid targetType: "+e+". Valid values are: "+JSON.stringify(targetTypes));const n=[],o=new RegExp("^get(.*)"+e+"$","i");for(const e in chatgpt)"function"==typeof chatgpt[e]&&o.test(e)&&n.push(e.replace(o,"$1").toLowerCase());if(!n.includes(t.toLowerCase()))throw new Error("Invalid targetName: "+t+". "+(n.length>0?"Valid values are: "+JSON.stringify(n):"targetType "+e.toLowerCase()+" does not require additional options."));const r=("get"+t+e).toLowerCase();return this[Object.keys(this).find((e=>e.toLowerCase()==r))]()},getAccessToken:function(){return new Promise(((e,t)=>{if(Object.keys(chatgpt.openAIaccessToken).length>0&&Date.parse(chatgpt.openAIaccessToken.expireDate)-Date.parse(new Date)>=0)return e(chatgpt.openAIaccessToken.token);const n=new XMLHttpRequest;n.open("GET",endpoints.openAI.session,!0),n.setRequestHeader("Content-Type","application/json"),n.onload=()=>200!==n.status?t("ðŸ¤– chatgpt.js >> Request failed. Cannot retrieve access token."):(console.info("Token expiration: "+new Date(JSON.parse(n.responseText).expires).toLocaleString().replace(","," at")),chatgpt.openAIaccessToken={token:JSON.parse(n.responseText).accessToken,expireDate:JSON.parse(n.responseText).expires},e(chatgpt.openAIaccessToken.token)),n.send()}))},getAccountDetails:function(...e){const t=["email","id","image","name","picture"];e=arguments[0]?Array.isArray(arguments[0])?arguments[0]:Array.from(arguments):t;for(const n of e)if(!t.includes(n))return console.error("Invalid detail arg '"+n+"' supplied. Valid details are:\n                    ["+t+"]");return new Promise(((t,n)=>{const o=new XMLHttpRequest;o.open("GET",endpoints.openAI.session,!0),o.setRequestHeader("Content-Type","application/json"),o.onload=()=>{if(200===o.status){const n=JSON.parse(o.responseText).user,r={};for(const t of e)r[t]=n[t];return t(r)}return n("ðŸ¤– chatgpt.js >> Request failed. Cannot retrieve account details.")},o.send()}))},getChatBox:function(){return document.getElementById("prompt-textarea")},getChatData:function(e=1,t="all",n="all",o="all"){const r=["all","id","title","create_time","update_time","msg"],s=["all","both","user","chatgpt"];e=e?Number.isInteger(e)||/^\d+$/.test(e)?0===parseInt(e,10)?0:parseInt(e,10)-1:e:"active",t=["all",""].includes(t)?r.filter((e=>/^(?!all$|msg$).*/.test(e))):Array.isArray(t)?t:[t],n=n?s.includes(n)?n:"invalid":"all",o=Number.isInteger(o)||/^\d+$/.test(o)?0===parseInt(o,10)?0:parseInt(o,10)-1:["all","latest"].includes(o.toLowerCase())?o.toLowerCase():o?"invalid":"all";for(const e of t)if(!r.includes(e))return console.error("Invalid detail arg '"+e+"' passed. Valid details are:\n                    ["+r+"]");if("invalid"==n)return console.error("Invalid sender arg passed. Valid senders are:\n                    ["+s+"]");if("invalid"==o)return console.error("Invalid msgToGet arg passed. Valid msg's to get are:\n                    [ 'all' | 'latest' | index of msg to get ]");const a=(t,n)=>{const o=/\w{8}-\w{4}-\w{4}-\w{4}-\w{12}/;return new Promise(((r,s)=>{const a=new XMLHttpRequest;a.open("GET",endpoints.openAI.chats,!0),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Authorization","Bearer "+t),a.onload=()=>{if(200!==a.status)return s("ðŸ¤– chatgpt.js >> Request failed. Cannot retrieve chat details.");const t=JSON.parse(a.responseText).items;if(t.length<=0)return s("ðŸ¤– chatgpt.js >> Chat list is empty.");const i={};if(Number.isInteger(e)||"latest"==e||"active"==e&&!new RegExp("/"+o.source+"$").test(window.location.href)){if((e=Number.isInteger(e)?e:0)>t.length)return s("ðŸ¤– chatgpt.js >> Chat with index "+(e+1)+" is out of bounds. Only "+t.length+" chats exist!");for(const o of n)i[o]=t[e][o];return r(i)}const c="active"==e||new RegExp("^"+o.source+"$").test(e)?"id":"title";let l,u;for("active"==e&&(e=o.exec(window.location.href)[0]),l=0;l<t.length;l++)if(t[l][c]==e){u=!0;break}if(!u)return s("ðŸ¤– chatgpt.js >> No chat with "+c+" = "+e+" found.");for(const e of n)i[e]=t[l][e];return r(i)},a.send()}))};return new Promise((e=>{chatgpt.getAccessToken().then((r=>{t.includes("msg")?(e=>new Promise(((t,r)=>{const s=new XMLHttpRequest;a(e,["id"]).then((a=>{s.open("GET",`${endpoints.openAI.chat}/${a.id}`,!0),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Authorization","Bearer "+e),s.onload=()=>{if(200!==s.status)return r("ðŸ¤– chatgpt.js >> Request failed. Cannot retrieve chat messages.");const e=JSON.parse(s.responseText).mapping,a=[],i=[],c=[];for(const t in e)null!=e[t].message&&"user"==e[t].message.author.role&&a.push({id:e[t].id,msg:e[t].message});if(a.sort(((e,t)=>e.msg.create_time-t.msg.create_time)),parseInt(o,10)+1>a.length)return r("ðŸ¤– chatgpt.js >> Message/response with index "+(o+1)+" is out of bounds. Only "+a.length+" messages/responses exist!");for(const t of a){let n=[];for(const o in e)null!=e[o].message&&"assistant"==e[o].message.author.role&&e[o].parent==t.id&&n.push(e[o].message);n.sort(((e,t)=>e.create_time-t.create_time)),n=n.map((e=>{switch(e.content.content_type){case"code":return e.content.text;case"text":return e.content.parts[0];default:return}})),n=1===n.length?n[0]:n,i.push(n)}if("user"==n)for(const e in a)c.push(a[e].msg.content.parts[0]);else if("chatgpt"==n)for(const e of i)c.push("latest"==o?i[i.length-1]:e);else{let e=0;for(const t in a)c.push({user:a[t].msg.content.parts[0],chatgpt:"latest"==o?i[e][i[e].length-1]:i[e]}),e++}return t("all"==o?c:"latest"==o?c[c.length-1]:c[o])},s.send()}))})))(r).then((t=>e(t))):a(r,t).then((t=>e(t)))}))}))},getChatInput:function(){return chatgpt.getChatBox().value},getContinueGeneratingButton:function(){for(const e of document.querySelectorAll("form button svg"))if(e.querySelector('polygon[points*="11 19 2 12 11 5 11 19"]'))return e.parentNode.parentNode},getLastPrompt:function(){return chatgpt.getChatData("active","msg","user","latest")},getLastResponse:function(){return chatgpt.getChatData("active","msg","chatgpt","latest")},getNewChatLink:function(){for(const e of document.querySelectorAll("nav a"))if(/(new|clear) chat/i.test(e.text))return e},getRegenerateButton:function(){for(const e of document.querySelectorAll("main svg"))if(e.querySelector('path[d*="M4.5 2.5C5.05228"]'))return e.parentNode.parentNode},getResponse:function(){return window.location.href.startsWith("https://chat.openai.com/c/")?chatgpt.getResponseFromDOM.apply(null,arguments):chatgpt.getResponseFromAPI.apply(null,arguments)},getResponseFromAPI:function(e,t){return chatgpt.response.getFromAPI(e,t)},getResponseFromDOM:function(e){return chatgpt.response.getFromDOM(e)},getSendButton:function(){return document.querySelector('form button[class*="bottom"]')},getStopGeneratingButton:function(){for(const e of document.querySelectorAll("form button svg"))if(e.querySelector('path[d*="2 0 0 1 2"]'))return e.parentNode},getUserLanguage:function(){return navigator.languages[0]||navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage||""},history:{isLoaded:function(){return new Promise((e=>{const t=()=>{document.querySelector("nav")?e(!0):setTimeout(t,100)};t()}))}},instructions:{add:function(e,t){if(!e)return console.error("Please provide an instruction");if("string"!=typeof e)return console.error("Instruction must be a string");const n=["user","chatgpt"];return t?"string"!=typeof t?console.error("Target must be a string"):(t=t.toLowerCase(),n.includes(t)?(e=`\n\n${e}`,new Promise((n=>{chatgpt.getAccessToken().then((async o=>{const r=await this.fetchData();return"user"==t?r.about_user_message+=e:"chatgpt"==t&&(r.about_model_message+=e),await this.sendRequest("POST",o,r),n()}))}))):console.error(`Invalid target ${t}. Valid targets are [${n}]`)):console.error("Please provide a valid target!")},clear:function(e){const t=["user","chatgpt"];return e?"string"!=typeof e?console.error("Target must be a string"):(e=e.toLowerCase(),t.includes(e)?new Promise((t=>{chatgpt.getAccessToken().then((async n=>{const o=await this.fetchData();return"user"==e?o.about_user_message="":"chatgpt"==e&&(o.about_model_message=""),await this.sendRequest("POST",n,o),t()}))})):console.error(`Invalid target ${e}. Valid targets are [${t}]`)):console.error("Please provide a valid target!")},fetchData:function(){return new Promise((e=>{chatgpt.getAccessToken().then((async t=>e(await this.sendRequest("GET",t))))}))},sendRequest:function(e,t,n){for(let e=0;e<arguments.length-1;e++)if("string"!=typeof arguments[e])return console.error(`Argument ${e+1} must be a string`);const o=["POST","GET"];return(e=(e||"").trim().toUpperCase())&&o.includes(e)?t?n&&"object"!=typeof n?console.error(`Invalid body data type. Got ${typeof n}, expected object`):new Promise(((o,r)=>{const s=new XMLHttpRequest;s.open(e,endpoints.openAI.instructions,!0),s.setRequestHeader("Accept-Language","en-US"),s.setRequestHeader("Authorization","Bearer "+t),"POST"==e&&s.setRequestHeader("Content-Type","application/json"),s.onload=()=>{const t=JSON.parse(s.responseText);return 422===s.status?r("ðŸ¤– chatgpt.js >> Character limit exceeded. Custom instructions can have a maximum length of 1500 characters."):403===s.status&&"content_policy"==t.detail.reason?r("ðŸ¤– chatgpt.js >> "+t.detail.description):200!==s.status?r("ðŸ¤– chatgpt.js >> Request failed. Cannot contact custom instructions endpoint."):(console.info(`Custom instructions successfully contacted with method ${e}`),o(t||{}))},s.send(JSON.stringify(n)||"")})):console.error("Please provide a valid access token!"):console.error(`Valid methods are ${o}`)},turnOff:function(){return new Promise((e=>{chatgpt.getAccessToken().then((async t=>{const n=await this.fetchData();return n.enabled=!1,await this.sendRequest("POST",t,n),e()}))}))},turnOn:function(){return new Promise((e=>{chatgpt.getAccessToken().then((async t=>{const n=await this.fetchData();return n.enabled=!0,await this.sendRequest("POST",t,n),e()}))}))},toggle:function(){return new Promise((e=>{this.fetchData().then((async t=>(await(t.enabled?this.turnOff():this.turnOn()),e())))}))}},isChromium:function(){return chatgpt.browser.isChromium()},isDarkMode:function(){return document.documentElement.classList.toString().includes("dark")},isFirefox:function(){return chatgpt.browser.isFirefox()},isFullScreen:function(){return chatgpt.browser.isFullScreen()},isIdle:function(){return new Promise((e=>{const t=setInterval((()=>{chatgpt.getRegenerateButton()&&(clearInterval(t),e(!0))}),100)}))},isLoaded:function(){return new Promise((e=>{const t=setInterval((()=>{document.querySelector('nav button[id*="menu"]')&&(clearInterval(t),setTimeout((()=>{e(!0)}),500))}),100)}))},isLightMode:function(){return document.documentElement.classList.toString().includes("light")},isMobileDevice:function(){return chatgpt.browser.isMobile()},logout:function(){window.location.href="https://chat.openai.com/auth/logout"},menu:{elements:[],addedEvent:!1,append:function(e,t={}){const n=["button","dropdown"];if(!e||"string"!=typeof e)return console.error("ðŸ¤– chatgpt.js >> Please supply a valid string element name!");if(e=e.toLowerCase(),!n.includes(e))return console.error(`ðŸ¤– chatgpt.js >> Invalid element! Valid elements are [${n}]`);const o=document.createElement("dropdown"==e?"select":"button"==e?"a":e);if(o.id=Math.floor(1e6*chatgpt.randomFloat())+Date.now(),"button"==e){o.textContent=t?.label&&"string"==typeof t.label?t.label:"chatgpt.js button";const e=document.createElement("img");e.src=t?.icon&&"string"==typeof t.icon?t.icon:endpoints.assets+"/starters/chrome/extension/icons/icon128.png",e.width=18,o.insertBefore(e,o.firstChild),o.onclick=t?.onclick&&"function"==typeof t.onclick?t.onclick:function(){}}else if("dropdown"==e){if(t?.items&&Array.isArray(t.items)&&t.items.length||(t.items=[{text:"ðŸ¤– chatgpt.js option",value:"chatgpt.js option value"}]),!t.items.every((e=>"object"==typeof e)))return console.error("'items' must be an array of objects!");o.style="background-color: #000; width: 100%; border: none;",t.items.forEach((e=>{const t=document.createElement("option");t.textContent=e?.text,t.value=e?.value,o.add(t)}))}const r=()=>{const e=document.querySelectorAll('a[role="menuitem"]');let t;for(let n of e)if("Settings"==n.textContent){t=n.classList;break}const n=e[0].parentNode;chatgpt.menu.elements.forEach((e=>{if(e.setAttribute("class",t),!n.contains(e))try{n.insertBefore(e,n.firstChild)}catch(e){console.error(e)}}))};this.elements.push(o);const s=document.querySelector('nav button[id*="headless"]');return this.addedEvent||(s.addEventListener("click",(()=>{setTimeout(r,25)})),this.addedEvent=!0),o.id},close:function(){const e=document.querySelector('nav [id*="menu-button"][aria-expanded="true"]');if(!e)throw console.error("Menu already hidden!"),new Error;try{e.click()}catch(e){throw console.error("Error while closing the menu"),new Error(e)}},open:function(){const e=document.querySelector('nav [id*="menu-button"][aria-expanded="false"]');if(!e)throw console.error("Menu already hidden!"),new Error;try{e.click()}catch(e){throw console.error("Error while closing the menu"),new Error(e)}}},minify:function(){chatgpt.code.minify()},notify:async function(e,t,n,o){n=n?+n:1.75;const r=document.createElement("div");r.id=Math.floor(1e6*chatgpt.randomFloat())+Date.now(),r.classList.add("chatgpt-notif"),r.innerText=e,document.body.append(r);const s=document.createElement("div");s.title="Dismiss",s.classList.add("notif-close-btn");const a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("height","8px"),a.setAttribute("viewBox","0 0 14 14"),a.setAttribute("fill","none"),a.style.height=a.style.width="8px";const i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("fill-rule","evenodd"),i.setAttribute("clip-rule","evenodd"),i.setAttribute("fill","white"),i.setAttribute("d","M13.7071 1.70711C14.0976 1.31658 14.0976 0.683417 13.7071 0.292893C13.3166 -0.0976312 12.6834 -0.0976312 12.2929 0.292893L7 5.58579L1.70711 0.292893C1.31658 -0.0976312 0.683417 -0.0976312 0.292893 0.292893C-0.0976312 0.683417 -0.0976312 1.31658 0.292893 1.70711L5.58579 7L0.292893 12.2929C-0.0976312 12.6834 -0.0976312 13.3166 0.292893 13.7071C0.683417 14.0976 1.31658 14.0976 1.70711 13.7071L7 8.41421L12.2929 13.7071C12.6834 14.0976 13.3166 14.0976 13.7071 13.7071C14.0976 13.3166 14.0976 12.6834 13.7071 12.2929L8.41421 7L13.7071 1.70711Z"),a.append(i),s.append(a),r.append(s),r.isTop=!t||!/low|bottom/i.test(t),r.isRight=!t||!/left/i.test(t),r.quadrant=(r.isTop?"top":"bottom")+(r.isRight?"Right":"Left");const c=20231110;let l=document.querySelector("#chatgpt-notif-style");(!l||parseInt(l.getAttribute("last-updated"),10)<c)&&(l||(l=document.createElement("style"),l.id="chatgpt-notif-style",l.setAttribute("last-updated",c.toString()),document.head.append(l)),l.innerText=`.chatgpt-notif {background-color: black ; padding: 10px 13px 10px 18px ; border-radius: 11px ; border: 1px solid #f5f5f7 ;opacity: 0 ; position: fixed ; z-index: 9999 ; font-size: 1.8rem ; color: white ;-webkit-user-select: none ; -moz-user-select: none ; -ms-user-select: none ; user-select: none ;transform: translateX(${r.isRight?"":"-"}35px) ;`+(o?"box-shadow: -8px 13px 25px 0 "+(/\b(shadow|on)\b/gi.test(o)?"gray":o):"")+"}.notif-close-btn { cursor: pointer ; float: right ; position: relative ; right: -4px ; margin-left: -3px ;display: grid }@keyframes notif-zoom-fade-out { 0% { opacity: 1 ; transform: scale(1) }15% { opacity: 0.35 ; transform: rotateX(-27deg) scale(1.05) }45% { opacity: 0.05 ; transform: rotateX(-81deg) }100% { opacity: 0 ; transform: rotateX(-180deg) scale(1.15) }}");let u=JSON.parse(localStorage.notifyProps);u.queue[r.quadrant].push(r.id),localStorage.notifyProps=JSON.stringify(u),r.style.top=r.isTop?23..toString()+"px":"",r.style.bottom=r.isTop?"":23..toString()+"px",r.style.right=r.isRight?27..toString()+"px":"",r.style.left=r.isRight?"":27..toString()+"px";const d=u.queue[r.quadrant];if(d.length>1)try{for(const e of d.slice(0,-1)){const t=document.getElementById(e),n=t.style.top?"top":"bottom",o=+/\d+/.exec(t.style[n])[0]+5+t.getBoundingClientRect().height;t.style[n]=`${o}px`}}catch(e){}setTimeout((()=>{r.style.opacity=chatgpt.isDarkMode()?.8:.67,r.style.transform="translateX(0)",r.style.transition="transform 0.15s ease, opacity 0.15s ease"}),10);const p=()=>{r.style.animation="notif-zoom-fade-out 0.3s ease-out",clearTimeout(g)},g=setTimeout(p,1e3*(.3>n?0:n-.3));a.addEventListener("click",p,{once:!0}),r.addEventListener("animationend",(()=>{r.remove(),u=JSON.parse(localStorage.notifyProps),u.queue[r.quadrant].shift(),localStorage.notifyProps=JSON.stringify(u)}),{once:!0})},obfuscate:function(){chatgpt.code.obfuscate()},printAllFunctions:function(){const e={cmdPrompt:["#ff00ff","#00ff00"],objName:["#0611e9","#f9ee16"],methodName:["#005aff","#ffa500"],entryType:["#467e06","#b981f9"],srcMethod:["#ff0000","#00ffff"]};Object.keys(e).forEach((t=>{e[t][1]=e[t][1]||"#"+(16777215^Number(`0x1${e[t][0].replace(/^#/,"")}`)).toString(16).substring(1).toUpperCase()}));const t=[];for(const e in this)if("function"==typeof this[e]){const n=!Object.keys(this).find((t=>Object.keys(this[t]).includes(this[e].name)))?"chatgpt":"other";t.push([n,e])}else if("object"==typeof this[e])for(const n in this[e])"function"==typeof this[e][n]&&t.push([e,n]);t.sort(((e,t)=>e[0].localeCompare(t[0])||e[1].localeCompare(t[1])));const n=window.matchMedia("(prefers-color-scheme: dark)").matches,o="font-family: monospace ; font-size: larger ; ";console.log("\n%cðŸ¤– chatgpt.js methods\n","font-family: sans-serif ; font-size: xxx-large ; font-weight: bold");for(const r of t){const t=/chatgpt|other/.test(r[0]),s="chatgpt"==r[0]?this[r[1]].name:"other"!==r[0]?r[0]+"."+r[1]:Object.keys(this).find((e=>Object.keys(this[e]).includes(this[r[1]].name)))+"."+this[r[1]].name,a="AsyncFunction"==this[r[1]]?.constructor.name;console.log("%c>> %c"+(t?"":`${r[0]}.%c`)+r[1]+" - https://chatgptjs.org/userguide/"+/(?:.*\.)?(.*)/.exec(s)[1].toLowerCase()+(a?"-async":"")+"\n%c[%c"+("chatgpt"==r[0]&&r[1]==this[r[1]].name||!t?"Function":"Alias of")+"%c: %c"+s+"%c]",o+"font-weight: bold ; color:"+e.cmdPrompt[+n],o+"font-weight: bold ;color:"+e[t?"methodName":"objName"][+n],o+"font-weight: "+(t?"initial":"bold")+";color:"+(t?"initial":e.methodName[+n]),o+"font-weight: "+(t?"bold":"initial")+";color:"+(t?e.entryType[+n]:"initial"),o+"font-weight: "+(t?"initial":"bold")+";color:"+(t?"initial":e.entryType[+n]),o+(t?"font-style: italic":"font-weight: initial")+";color:"+(t?e.srcMethod[+n]:"initial"),o+(t?"font-weight: initial":"font-style: italic")+";color:"+(t?"initial":e.srcMethod[+n]),t?"":o+"color: initial ; font-weight: initial")}},randomFloat:function(){return(window.crypto||window.msCrypto).getRandomValues(new Uint32Array(1))[0]/4294967295},refactor:function(){chatgpt.code.refactor()},regenerate:function(){for(const e of document.querySelectorAll("form button"))if(e.textContent.toLowerCase().includes("regenerate"))return void e.click()},renderHTML:function(e){const t=/<([a-z\d]+)\b([^>]*)>([\s\S]*?)<\/\1>/g,n=/(\S+)=['"]?((?:.(?!['"]?\s+\S+=|[>']))+.)['"]?/g,o=e.childNodes;this.renderHTML.preWrapSet||(e.style.whiteSpace="pre-wrap",this.renderHTML.preWrapSet=!0,setTimeout((()=>{this.renderHTML.preWrapSet=!1}),100));for(const r of o)if(r.nodeType==Node.TEXT_NODE){const o=r.nodeValue,s=Array.from(o.matchAll(t));if(s.length>0){const t=s[0],[a,i,c,l]=t.slice(0,4),u=document.createElement(i);u.textContent=l;Array.from(c.matchAll(n)).forEach((e=>{const t=e[1],n=e[2].replace(/['"]/g,"");u.setAttribute(t,n)}));const d=this.renderHTML(u),p=document.createTextNode(o.substring(0,t.index)),g=document.createTextNode(o.substring(t.index+a.length));e.replaceChild(p,r),e.insertBefore(d,p.nextSibling),e.insertBefore(g,d.nextSibling)}}else r.nodeType==Node.ELEMENT_NODE&&this.renderHTML(r);return e},resend:async function(){chatgpt.send(await chatgpt.getChatData("latest","msg","user","latest"))},response:{get:function(){return window.location.href.startsWith("https://chat.openai.com/c/")?this.getFromDOM.apply(null,arguments):this.getFromAPI.apply(null,arguments)},getFromAPI:function(e,t){return e=e||"latest",t=t||"latest",chatgpt.getChatData(e,"msg","chatgpt",t)},getFromDOM:function(e){const t=document.querySelectorAll('div[data-testid*="conversation-turn"]:nth-child(odd)'),n=e.toString().toLowerCase();let o="";if(t.length){if(/last|final/.test(n))o=t[t.length-1].textContent;else{o=t[(Number.isInteger(e)?e:/^\d+/.test(n)?/^\d+/.exec(n)[0]:(/^(?:1|one|fir)(?:st)?$/.test(n)?1:/^(?:2|tw(?:o|en|el(?:ve|f))|seco)(?:nd|t[yi])?(?:e?th)?$/.test(n)?2:/^(?:3|th(?:ree|ir?))(?:rd|teen|t[yi])?(?:e?th)?$/.test(n)?3:/^(?:4|fou?r)(?:teen|t[yi])?(?:e?th)?$/.test(n)?4:/^(?:5|fi(?:ve|f))(?:teen|t[yi])?(?:e?th)?$/.test(n)?5:/^(?:6|six)(?:teen|t[yi])?(?:e?th)?$/.test(n)?6:/^(?:7|seven)(?:teen|t[yi])?(?:e?th)?$/.test(n)?7:/^(?:8|eight?)(?:teen|t[yi])?(?:e?th)?$/.test(n)?8:/^(?:9|nine?)(?:teen|t[yi])?(?:e?th)?$/.test(n)?9:/^(?:10|ten)(?:th)?$/.test(n)?10:1)*(/(ty|ieth)$/.test(n)?10:1)+(/teen(th)?$/.test(n)?10:0))-1].textContent}o=o.replace(/^ChatGPTChatGPT/,"")}return o},getLast:function(){return chatgpt.getChatData("active","msg","chatgpt","latest")},regenerate:function(){for(const e of document.querySelectorAll("form button"))if(e.textContent.toLowerCase().includes("regenerate"))return void e.click()},stopGenerating:function(){for(const e of document.querySelectorAll("form button svg"))if(e.querySelector('path[d*="2 0 0 1 2"]'))return void e.parentNode.click()}},reviewCode:function(){chatgpt.code.review()},scrollToBottom:function(){try{document.querySelector('button[class*="cursor"][class*="bottom"]').click()}catch(e){console.error("",e)}},send:function(e,t=""){for(let e=0;e<arguments.length;e++)if("string"!=typeof arguments[e])return console.error(`Argument ${e+1} must be a string!`);const n=document.querySelector("form textarea"),o=document.querySelector('form button[class*="bottom"]');n.value=e,n.dispatchEvent(new Event("input",{bubbles:!0}));const r=setInterval((()=>{o?.hasAttribute("disabled")||("click"==t.toLowerCase()||chatgpt.browser.isMobile()?o.click():n.dispatchEvent(new KeyboardEvent("keydown",{keyCode:13,bubbles:!0})),clearInterval(r))}),25)},sendInNewChat:function(e){if("string"!=typeof e)return console.error("Message must be a string!");for(const e of document.querySelectorAll("nav a"))if(/(new|clear) chat/i.test(e.text)){e.click();break}setTimeout((()=>{chatgpt.send(e)}),500)},settings:{scheme:{isDark:function(){return document.documentElement.classList.contains("dark")},isLight:function(){return document.documentElement.classList.contains("light")},set:function(e){const t=["dark","light","system"];if(!e)return console.error("Please specify a scheme value!");if(!t.includes(e))return console.error(`Invalid scheme value. Valid values are [${t}]`);let n=e;"system"==e&&(n=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),localStorage.setItem("theme",e),console.info(`Scheme set to ${e.toUpperCase()}.`),document.documentElement.classList.contains(n)||this.toggle()},toggle:function(){const[e,t]=this.isDark()?["dark","light"]:["light","dark"];document.documentElement.classList.replace(e,t),document.documentElement.style.colorScheme=t,localStorage.setItem("theme",t)}}},sentiment:async function(e,t){for(let e=0;e<arguments.length;e++)if("string"!=typeof arguments[e])return console.error(`Argument ${e+1} must be a string.`);return chatgpt.send("What is the sentiment of the following text"+(t?` towards the entity ${t},`:"")+" from strongly negative to strongly positive?\n\n"+e),console.info("Analyzing sentiment..."),await chatgpt.isIdle(),chatgpt.getChatData("active","msg","chatgpt","latest")},setScheme:function(e){chatgpt.settings.scheme.set(e)},shareChat:function(e,t="clipboard"){const n=["alert","notify","notification","clipboard","copy"];if(!n.includes(t))return console.error("Invalid method '"+t+"' passed. Valid methods are ["+n+"].");return new Promise((n=>{chatgpt.getAccessToken().then((o=>{(t=>new Promise(((n,o)=>{const r=new XMLHttpRequest;chatgpt.getChatData(e).then((e=>{r.open("GET",`${endpoints.openAI.chat}/${e.id}`,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Authorization","Bearer "+t),r.onload=()=>200!==r.status?o("ðŸ¤– chatgpt.js >> Request failed. Cannot retrieve chat node."):n(JSON.parse(r.responseText).current_node),r.send()}))})))(o).then((r=>{((t,n)=>new Promise(((o,r)=>{const s=new XMLHttpRequest;chatgpt.getChatData(e).then((e=>{s.open("POST",endpoints.openAI.share_create,!0),s.setRequestHeader("Content-Type","application/json"),s.setRequestHeader("Authorization","Bearer "+t),s.onload=()=>200!==s.status?r("ðŸ¤– chatgpt.js >> Request failed. Cannot initialize share chat."):o(JSON.parse(s.responseText)),s.send(JSON.stringify({current_node_id:n,conversation_id:e.id,is_anonymous:!0}))}))})))(o,r).then((e=>{((e,t)=>new Promise(((n,o)=>{const r=new XMLHttpRequest;r.open("PATCH",`${endpoints.openAI.share}/${t.share_id}`,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Authorization","Bearer "+e),r.onload=()=>200!==r.status?o("ðŸ¤– chatgpt.js >> Request failed. Cannot share chat."):(console.info(`Chat shared at '${t.share_url}'`),n()),r.send(JSON.stringify({share_id:t.share_id,highlighted_message_id:t.highlighted_message_id,title:t.title,is_public:!0,is_visible:t.is_visible,is_anonymous:t.is_anonymous}))})))(o,e).then((()=>{["copy","clipboard"].includes(t)?navigator.clipboard.writeText(e.share_url):chatgpt.alert("ðŸš€ Share link created!",'"'+e.title+'" is available at: <a target="blank" rel="noopener" href="'+e.share_url+'" >'+e.share_url+"</a>",[function(){window.open(e.share_url,"_blank","noopener")},function(){navigator.clipboard.writeText(e.share_url)}]),n(e.share_url)}))}))}))}))}))},sidebar:{elements:[],observer:{},activateObserver:function(){const e=document.querySelector("nav").querySelector("a");if(chatgpt.history.isOff())try{e.parentNode.nextElementSibling.style.display="none"}catch(e){}if(this.observer instanceof MutationObserver)try{this.observer.disconnect()}catch(e){}if(!this.elements.length)return console.error("ðŸ¤– chatgpt.js >> No elements to append!");let t;for(let e of document.querySelectorAll("nav a"))if(/.*chat/.exec(e.text)[0]){t=e.classList,e.parentNode.style.margin="2px 0";break}this.elements.forEach((e=>{e.setAttribute("class",t),e.style.maxHeight=e.style.minHeight="44px",e.style.margin="2px 0"}));const n=document.querySelector("nav");this.observer=new MutationObserver((e=>{e.forEach((e=>{("childList"==e.type&&e.addedNodes.length||"attributes"==e.type&&"data-chatgptjs"==e.attributeName)&&this.elements.forEach((e=>{if(!n.contains(e))try{n.insertBefore(e,n.querySelector("a").parentNode)}catch(e){console.error(e)}}))}))})),this.observer.observe(document.documentElement,{childList:!0,subtree:!0,attributes:!0})},append:function(e,t={}){const n=["button","dropdown"];if(!e||"string"!=typeof e)return console.error("ðŸ¤– chatgpt.js >> Please supply a valid string element name!");if(e=e.toLowerCase(),!n.includes(e))return console.error(`ðŸ¤– chatgpt.js >> Invalid element! Valid elements are [${n}]`);const o=document.createElement("dropdown"==e?"select":e);if(o.id=Math.floor(1e6*chatgpt.randomFloat())+Date.now(),"button"==e){o.textContent=t?.label&&"string"==typeof t.label?t.label:"chatgpt.js button";const e=document.createElement("img");e.src=t?.icon&&"string"==typeof t.icon?t.icon:endpoints.assets+"/starters/chrome/extension/icons/icon128.png",e.width=18,o.insertBefore(e,o.firstChild),o.onclick=t?.onclick&&"function"==typeof t.onclick?t.onclick:function(){}}else if("dropdown"==e){if(t?.items&&Array.isArray(t.items)&&t.items.length||(t.items=[{text:"ðŸ¤– chatgpt.js option",value:"chatgpt.js option value"}]),!t.items.every((e=>"object"==typeof e)))return console.error("'items' must be an array of objects!");t.items.forEach((e=>{const t=document.createElement("option");t.textContent=e?.text,t.value=e?.value,o.add(t)}))}return"dropdown"==e&&(o.style.backgroundColor="var(--gray-900, rgb(32, 33, 35))"),this.elements.push(o),this.activateObserver(),document.body.setAttribute("data-chatgptjs","observer-trigger"),o.id},hide:function(){this.isOn()?this.toggle():console.info("Sidebar already hidden!")},show:function(){this.isOff()?this.toggle():console.info("Sidebar already shown!")},isOff:function(){return!this.isOn()},isOn:function(){return chatgpt.browser.isMobile()?"hidden"==document.documentElement.style.overflow:"hidden"!=document.querySelector("#__next > div > div").style.visibility},toggle:function(){const e=chatgpt.browser.isMobile(),t=e?"#__next button":"main button",n=e?()=>!0:e=>Array.from(e.querySelectorAll("*")).some((e=>e.style.transform.includes("translateY")));for(const e of document.querySelectorAll(t))if(n(e))return void e.click()}},startNewChat:function(){for(const e of document.querySelectorAll("nav a"))if(/(new|clear) chat/i.test(e.text))return void e.click()},stop:function(){this.response.stopGenerating()},suggest:async function(e,t){if(!e)return console.error("ideaType (1st argument) not supplied(e.g. 'gifts', 'names', 'recipes', etc.)");for(let e=0;e<arguments.length;e++)if("string"!=typeof arguments[e])return console.error(`Argument ${e+1} must be a string.`);return chatgpt.send("Suggest some names. "+(t||"")),console.info(`Creating ${e}...`),await chatgpt.isIdle(),chatgpt.getChatData("active","msg","chatgpt","latest")},speak:function(e,t={}){const{voice:n=2,pitch:o=2,speed:r=1.1}=t;if("string"!=typeof e)return console.error("Message must be a string!");for(let e in t){const n=t[e];if("number"!=typeof n&&!/^\d+$/.test(n))return console.error(`Invalid ${e} index '${n}'. Must be a number!`)}try{const t=speechSynthesis.getVoices(),s=new SpeechSynthesisUtterance;s.text=e,s.voice=t[n],s.pitch=o,s.rate=r,speechSynthesis.speak(s)}catch(e){console.error(e)}},summarize:async function(e){return e?"string"!=typeof e?console.error("Text argument must be a string!"):(chatgpt.send("Summarize the following text:\n\n"+e),console.info("Summarizing text..."),await chatgpt.isIdle(),chatgpt.getChatData("active","msg","chatgpt","latest")):console.error("Text (1st) argument not supplied. Pass some text!")},toggleScheme:function(){chatgpt.settings.scheme.toggle()},translate:async function(e,t){if(!e)return console.error("Text (1st) argument not supplied. Pass some text!");if(!t)return console.error("outputLang (2nd) argument not supplied. Pass a language!");for(let e=0;e<arguments.length;e++)if("string"!=typeof arguments[e])return console.error(`Argument ${e+1} must be a string!`);return chatgpt.send("Translate the following text to "+t+". Only reply with the translation.\n\n"+e),console.info("Translating text..."),await chatgpt.isIdle(),chatgpt.getChatData("active","msg","chatgpt","latest")},unminify:function(){chatgpt.code.unminify()},uuidv4:function(){let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const n=(e+window.crypto.getRandomValues(new Uint32Array(1))[0]/(Math.pow(2,32)-1)*16)%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))},writeCode:function(){chatgpt.code.write()}};chatgpt.scheme={...chatgpt.settings.scheme};const buttonActions=["click","get"],targetTypes=["button","link","div","response"];for(const e of buttonActions)chatgpt[e+"Button"]=function(t){const n=/^[.#]/.test(t)?document.querySelector(t):/send/i.test(t)?document.querySelector('form button[class*="bottom"]'):/scroll/i.test(t)?document.querySelector('button[class*="cursor"]'):function(){for(const e of document.querySelectorAll("button"))if(e.textContent.toLowerCase().includes(t.toLowerCase()))return e;for(const e of document.querySelectorAll("nav a"))if(e.textContent.toLowerCase().includes(t.toLowerCase()))return e}();if("click"!=e)return n;n.click()};const functionAliases=[["actAs","actas","act","become","persona","premadePrompt","preMadePrompt","prePrompt","preprompt","roleplay","rolePlay","rp"],["activateAutoRefresh","activateAutoRefresher","activateRefresher","activateSessionRefresher","autoRefresh","autoRefresher","autoRefreshSession","refresher","sessionRefresher"],["deactivateAutoRefresh","deactivateAutoRefresher","deactivateRefresher","deactivateSessionRefresher"],["detectLanguage","getLanguage"],["executeCode","codeExecute"],["exportChat","chatExport","export"],["getLastPrompt","getLastQuery","getMyLastMsg","getMyLastQuery"],["getTextarea","getTextArea","getChatbox","getChatBox"],["isFullScreen","isFullscreen"],["logOut","logout","logOff","logoff","signOut","signout","signOff","signoff"],["minify","codeMinify","minifyCode"],["new","newChat","startNewChat"],["obfuscate","codeObfuscate","obfuscateCode"],["printAllFunctions","showAllFunctions"],["refactor","codeRefactor","refactorCode"],["refreshReply","regenerate","regenerateReply"],["refreshSession","sessionRefresh"],["renderHTML","renderHtml","renderLinks","renderTags"],["reviewCode","codeReview"],["send","sendChat","sendMsg"],["sendInNewChat","sendNewChat"],["sentiment","analyzeSentiment","sentimentAnalysis"],["stop","stopGenerating"],["suggest","suggestion","recommend"],["toggleAutoRefresh","toggleAutoRefresher","toggleRefresher","toggleSessionRefresher"],["toggleScheme","toggleMode"],["translate","translation","translator"],["unminify","unminifyCode","codeUnminify"],["writeCode","codeWrite"]],synonyms=[["account","acct"],["activate","turnOn"],["analyze","check","evaluate","review"],["ask","send","submit"],["chat","conversation","convo"],["data","details"],["deactivate","deActivate","turnOff"],["execute","interpret","interpreter","run"],["generating","generation"],["minify","uglify"],["refactor","rewrite"],["regenerate","regen"],["render","parse"],["reply","response"],["sentiment","attitude","emotion","feeling","opinion","perception"],["speak","say","speech","talk","tts"],["summarize","tldr"],["unminify","beautify","prettify","prettyPrint"]],camelCaser=e=>e.map(((e,t)=>0===t||"s"==e?e:e.charAt(0).toUpperCase()+e.slice(1))).join("");for(const e in chatgpt){for(const t of functionAliases)if(t.includes(e))if(t.some((e=>e.includes(".")))){const n=t.find((e=>e.includes("."))).split(".")[1];for(const o of t)/^(\w+)/.exec(o)[1]!==e&&(chatgpt[o]=chatgpt[e][n])}else for(const n of t)n!==e&&(chatgpt[n]=chatgpt[e]);do{var newFunctionsCreated=!1;for(const e in chatgpt)if("function"==typeof chatgpt[e]){const t=e.split(/(?=[A-Zs])/);for(const n of t){const o=[].concat(...synonyms.filter((e=>e.includes(n.toLowerCase()))).map((e=>e.filter((e=>e!==n.toLowerCase())))));for(const r of o){const o=camelCaser(t.map((e=>e==n?r:e)));chatgpt[o]||(chatgpt[o]=chatgpt[e],newFunctionsCreated=!0)}}}}while(newFunctionsCreated)}const consolePrefix="ðŸ¤– chatgpt.js >> ",ogError=console.error,ogInfo=console.info;console.error=(...e)=>{e[0].startsWith(consolePrefix)?ogError(...e):ogError(consolePrefix+e[0],...e.slice(1))},console.info=e=>{e.startsWith(consolePrefix)?ogInfo(e):ogInfo(consolePrefix+e)};try{window.chatgpt=chatgpt}catch(e){}try{module.exports=chatgpt}catch(e){}
//# sourceMappingURL=/sm/16bcbff29dc3ed395a10b265d17bce4b1d49dca9fdd27b7bee4d3943a39c4c05.map